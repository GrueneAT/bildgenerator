/*! GrÃ¼ne Bildgenerator v1.0.0 | Built: 2025-10-08T11:38:35.756Z */
var GrueneApp=(()=>{var __defProp=Object.defineProperty,__defProps=Object.defineProperties;var __getOwnPropDescs=Object.getOwnPropertyDescriptors;var __getOwnPropSymbols=Object.getOwnPropertySymbols;var __hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable;var __defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__spreadValues=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a},__spreadProps=(a,b)=>__defProps(a,__getOwnPropDescs(b)),__name=(target,value)=>__defProp(target,"name",{value,configurable:!0});const AppConstants={FILE:{FILENAME_LENGTH:6,MAX_SIZE_MB:10,VALID_IMAGE_TYPES:["image/jpeg","image/png","image/webp","image/svg+xml"]},UI:{ALERT_DURATION:3e3,ALERT_FADE_SPEED:300,MAX_ALERTS:3,WIZARD_TOTAL_STEPS:4},CANVAS:{SCALE_MAX_MULTIPLIER:.002,SNAP_ZONE_RATIO:20,TARGET_FIND_TOLERANCE:15,CORNER_SIZE_MULTIPLIER:.03,BORDER_SCALE_FACTOR:2,PADDING:4,ROTATION_SNAP_TOLERANCE:2,ROTATION_SNAP_ANGLES:[0,90,180,270]},EXPORT:{DEFAULT_DPI:200,SCREEN_DPI:72,MAX_PIXELS:25e7,QR_MIN_SIZE:512,QR_MAX_SIZE:2048,QR_BORDER_PERCENT:.05},SCALING:{TEXT_DEFAULT_WIDTH_RATIO:.8,TEXT_DEFAULT_HEIGHT_RATIO:.5,IMAGE_DEFAULT_WIDTH_RATIO:.5,IMAGE_DEFAULT_HEIGHT_RATIO:.4,QR_DEFAULT_WIDTH_RATIO:.25,QR_DEFAULT_HEIGHT_RATIO:.25,CIRCLE_DEFAULT_WIDTH_RATIO:.3,CIRCLE_DEFAULT_HEIGHT_RATIO:.3,CROSS_DEFAULT_WIDTH_RATIO:.4,CROSS_DEFAULT_HEIGHT_RATIO:.3},CIRCLE_SIZES:{LARGE:{value:2,percentage:.9},MEDIUM:{value:3,percentage:.7},SMALL:{value:4,percentage:.5}},COLORS:{BACKGROUND_PRIMARY:"rgba(138, 180, 20)",BACKGROUND_SECONDARY:"rgba(83,132,48)",PINK_CIRCLE:"rgb(225,0,120)",LOGO_TEXT:"rgb(255,255,255)",TEXT_STROKE:"#000000",CORNER_COLOR:"yellow",BORDER_COLOR:"rgba(88,42,114)",CORNER_STROKE:"#000000"},FONTS:{DEFAULT_LOGO:"Gotham Narrow Bold",DEFAULT_TEXT:"Gotham Narrow Ultra Italic",PRELOAD_FONTS:["Gotham Narrow Ultra Italic","Gotham Narrow Book","Gotham Narrow Bold"]},LOGO:{SCALE_RATIO:10,TEXT_SCALE_LONG:4.8,TEXT_SCALE_SHORT:6,MAX_TEXT_LENGTH:16,LINE_HEIGHT:.8,ANGLE:-5.5,WIDTH_SCALE:.95,FILES:{LONG:"Gruene_Logo_245_268.png",SHORT:"Gruene_Logo_245_248.png",SMALL_LONG:"Gruene_Logo_120_131.png",SMALL_SHORT:"Gruene_Logo_120_121.png"}}},TemplateConstants={TEMPLATES:{story:{width:1080,height:1920,topBorderMultiplier:2,border:10,logoTop:.83,logoTextTop:.9423,dpi:200},post:{width:1080,height:1080,topBorderMultiplier:1,border:20,logoTop:.79,logoTextTop:.948,dpi:200},post_45:{width:1080,height:1350,topBorderMultiplier:1,border:20,logoTop:.815,logoTextTop:.959,dpi:200},event:{width:1200,height:628,topBorderMultiplier:1,border:20,logoTop:.678,logoTextTop:.9,dpi:200},facebook_header:{width:1958,height:745,topBorderMultiplier:1,border:20,logoTop:.6,logoTextTop:.872,dpi:150},a2:{width:4961,height:7016,topBorderMultiplier:1,border:10,logoTop:.804,logoTextTop:.929,dpi:150},a2_quer:{width:7016,height:4961,topBorderMultiplier:1,border:10,logoTop:.694,logoTextTop:.856,dpi:150},a3:{width:3508,height:4961,topBorderMultiplier:1,border:10,logoTop:.804,logoTextTop:.929,dpi:200},a3_quer:{width:4961,height:3508,topBorderMultiplier:1,border:10,logoTop:.694,logoTextTop:.856,dpi:200},a4:{width:2480,height:3508,topBorderMultiplier:1,border:10,logoTop:.804,logoTextTop:.929,dpi:250},a4_quer:{width:3508,height:2480,topBorderMultiplier:1,border:10,logoTop:.694,logoTextTop:.856,dpi:250},a5:{width:1748,height:2480,topBorderMultiplier:1,border:10,logoTop:.804,logoTextTop:.929,dpi:300},a5_quer:{width:2480,height:1748,topBorderMultiplier:1,border:10,logoTop:.694,logoTextTop:.856,dpi:300}},getTemplate(templateName){return this.TEMPLATES[templateName]||null},getCurrentTemplate(){const templateName=jQuery("#canvas-template").find(":selected").attr("value");return this.getTemplate(templateName)}},template_values=TemplateConstants.TEMPLATES;function currentTemplate(){return TemplateConstants.getCurrentTemplate()}__name(currentTemplate,"currentTemplate");window.AppConstants=AppConstants;window.TemplateConstants=TemplateConstants;window.template_values=template_values;window.currentTemplate=currentTemplate;const ValidationUtils={VALID_IMAGE_TYPES:["image/jpeg","image/png","image/webp","image/svg+xml"],isValidImage(fileType){return this.VALID_IMAGE_TYPES.includes(fileType)},isValidImageFile(file){return file?this.isValidImage(file.type):!1},isValidJSON(str){try{return JSON.parse(str),!0}catch(e){return!1}},validateStep1(){const template2=jQuery("#canvas-template").val(),logo2=jQuery("#logo-selection").val(),errors=[];return template2||errors.push("Bitte w\xE4hlen Sie eine Vorlage aus."),logo2||errors.push("Bitte w\xE4hlen Sie ein Logo aus."),{isValid:errors.length===0,errors}},validateTextInput(text){return!text||text.trim()===""?{isValid:!1,error:"Text field is empty"}:{isValid:!0,error:null}},validateQRInput(text){return!text||text.trim()===""?{isValid:!1,error:"QR Code Text field is empty"}:typeof QRCode=="undefined"?{isValid:!1,error:"QR Code library not loaded"}:{isValid:!0,error:null}},validateCanvasObject(object,allowedTypes=[]){return object?allowedTypes.length>0&&!allowedTypes.includes(object.type)?{isValid:!1,error:`Invalid object type. Expected: ${allowedTypes.join(", ")}, got: ${object.type}`}:{isValid:!0,error:null}:{isValid:!1,error:"No object selected"}},validateCircleClipTarget(activeObject){return activeObject?activeObject===contentImage?{isValid:!1,error:'Kreis-Ausschnitt kann nicht auf das Hintergrundbild angewendet werden. F\xFCgen Sie zuerst ein eigenes Bild \xFCber "Bild hinzuf\xFCgen" ein.',type:"warning"}:activeObject===logo||activeObject===logoName?{isValid:!1,error:"Kreis-Ausschnitt kann nicht auf das Logo angewendet werden. W\xE4hlen Sie ein eingef\xFCgtes Bild aus.",type:"warning"}:activeObject.type==="image"||activeObject.type==="rect"||activeObject.type==="circle"?{isValid:!0,error:null}:{isValid:!1,error:"Kreis-Ausschnitt kann nur auf eingef\xFCgte Bilder und Elemente angewendet werden. W\xE4hlen Sie zuerst ein Element aus.",type:"warning"}:{isValid:!1,error:"Bitte w\xE4hlen Sie zuerst ein Element aus, um einen Kreis-Ausschnitt anzuwenden.",type:"warning"}},validateDownload(){return!logoText||logoText===""?{isValid:!1,error:"W\xE4hle bitte ein Logo aus vor dem Download!"}:{isValid:!0,error:null}},validateFileSize(file,maxSizeMB=10){if(!file)return{isValid:!1,error:"No file provided"};const maxSizeBytes=maxSizeMB*1024*1024;return file.size>maxSizeBytes?{isValid:!1,error:`File too large. Maximum size is ${maxSizeMB}MB`}:{isValid:!0,error:null}}};window.ValidationUtils=ValidationUtils;const AlertSystem={config:{duration:5e3,fadeSpeed:300,maxAlerts:3},alertTypes:{success:{classes:"bg-green-50 border-green-200 text-green-800",iconColor:"text-green-500",icon:"fas fa-check-circle"},warning:{classes:"bg-yellow-50 border-yellow-200 text-yellow-800",iconColor:"text-yellow-500",icon:"fas fa-exclamation-triangle"},danger:{classes:"bg-red-50 border-red-200 text-red-800",iconColor:"text-red-500",icon:"fas fa-exclamation-circle"},error:{classes:"bg-red-50 border-red-200 text-red-800",iconColor:"text-red-500",icon:"fas fa-exclamation-circle"},info:{classes:"bg-blue-50 border-blue-200 text-blue-800",iconColor:"text-blue-500",icon:"fas fa-info-circle"}},getContainer(){let container=jQuery(".alert-container");return container.length===0&&(container=jQuery('<div class="alert-container max-w-7xl mx-auto px-4 mt-4 hidden"></div>'),jQuery("body").prepend(container)),container},show(message,type="info",options={}){const container=options.container?jQuery(options.container):this.getContainer();return this.showInContainer(message,type,container,options)},showInContainer(message,type="info",container,options={}){const alertConfig=this.alertTypes[type]||this.alertTypes.info;if(container.length===0)return null;if(options.clearExisting)container.empty();else{const existingAlerts=container.find(".alert");existingAlerts.length>=this.config.maxAlerts&&existingAlerts.first().remove()}const alertHTML=`
            <div class="alert ${alertConfig.classes} border rounded-lg p-4 mb-4 shadow-sm fade-in flex items-start space-x-3" role="alert">
                <div class="flex-shrink-0">
                    <i class="${alertConfig.icon} ${alertConfig.iconColor}"></i>
                </div>
                <div class="flex-1">
                    <p class="text-sm font-medium">${message}</p>
                </div>
                <div class="flex-shrink-0">
                    <button type="button" class="text-gray-400 hover:text-gray-600 focus:outline-none alert-close-btn">
                        <span class="sr-only">Schlie\xDFen</span>
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
        `;container.removeClass("hidden").append(alertHTML);const newAlert=container.find(".alert").last();return newAlert.find(".alert-close-btn").on("click",()=>{this.closeAlertInContainer(newAlert,container)}),options.autoClose!==!1&&setTimeout(()=>{this.closeAlertInContainer(newAlert,container)},options.duration||this.config.duration),options.scrollIntoView&&this.scrollAlertIntoView(container),newAlert},closeAlert(alertElement){const container=this.getContainer();this.closeAlertInContainer(alertElement,container)},closeAlertInContainer(alertElement,container){alertElement.fadeOut(this.config.fadeSpeed,()=>{alertElement.remove(),container.find(".alert").length===0&&container.addClass("hidden")})},scrollAlertIntoView(container){},closeAll(){const container=this.getContainer();container.find(".alert").fadeOut(this.config.fadeSpeed,function(){jQuery(this).remove()}),setTimeout(()=>{container.addClass("hidden")},this.config.fadeSpeed)},success(message,options={}){return this.show(message,"success",options)},warning(message,options={}){return this.show(message,"warning",options)},error(message,options={}){return this.show(message,"error",options)},danger(message,options={}){return this.show(message,"danger",options)},info(message,options={}){return this.show(message,"info",options)},showQRAlert(message,type="info",options={}){const qrOptions=__spreadValues({container:"#qr-alert-container",clearExisting:!0,scrollIntoView:!0},options),qrAlert=this.showInContainer(message,type,jQuery("#qr-alert-container"),qrOptions),mainAlert=this.show(message,type,{autoClose:options.autoClose});return{qrAlert,mainAlert}},showTailwindAlert(message,type="info"){return this.show(message,type)}};function showAlert(message,type="danger"){return AlertSystem.show(message,type)}__name(showAlert,"showAlert");function showTailwindAlert(message,type="info"){return AlertSystem.show(message,type)}__name(showTailwindAlert,"showTailwindAlert");window.AlertSystem=AlertSystem;window.showAlert=showAlert;window.showTailwindAlert=showTailwindAlert;window.showQRAlert=showQRAlert;jQuery(document).ready(function(){jQuery("#alert-system-styles").length||jQuery("head").append(`
            <style id="alert-system-styles">
                .fade-in {
                    animation: fadeIn 0.3s ease-in-out;
                }
                
                @keyframes fadeIn {
                    from {
                        opacity: 0;
                        transform: translateY(-10px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }
                
                .alert-close-btn:hover {
                    opacity: 0.75;
                }
            </style>
        `)});const CanvasUtils={scaleElementToFit(element,maxWidthRatio=.5,maxHeightRatio=.4){const maxWidth=canvas.width*maxWidthRatio,maxHeight=canvas.height*maxHeightRatio,elementWidth=element.width||element.getScaledWidth(),elementHeight=element.height||element.getScaledHeight(),widthScale=maxWidth/elementWidth,heightScale=maxHeight/elementHeight,scale=Math.min(widthScale,heightScale);element.type==="text"||element.scaleToWidth&&element.scaleToHeight?widthScale<heightScale?element.scaleToWidth(maxWidth):element.scaleToHeight(maxHeight):element.scale(scale),element.setCoords()},disableScalingControls(object){object.setControlsVisibility({mt:!1,mb:!1,ml:!1,mr:!1,bl:!1,br:!1,tl:!1,tr:!1,mtr:!1})},relativeScalingControlsOnly(object){object.setControlsVisibility({mt:!1,mb:!1,ml:!1,mr:!1,bl:!0,br:!0,tl:!0,tr:!0,mtr:!0})},enableSnap(canvasInstance,snapZone=null){snapZone||(snapZone=canvasInstance.width/AppConstants.CANVAS.SNAP_ZONE_RATIO),canvasInstance.on("object:moving",function(options){const target=options.target;if(target===contentImage||target===logo||target===logoName||!target||typeof target.getCenterPoint!="function")return;const objectCenter=target.getCenterPoint(),canvasCenter=canvasInstance.width/2;if(Math.abs(objectCenter.x-canvasCenter)<snapZone){const centerBefore=target.getCenterPoint(),deltaX=canvasCenter-centerBefore.x;target.set({left:target.left+deltaX}),target.setCoords();const centerAfter=target.getCenterPoint()}})},enableRotationSnap(canvasInstance,tolerance=null){tolerance||(tolerance=AppConstants.CANVAS.ROTATION_SNAP_TOLERANCE);const snapAngles=AppConstants.CANVAS.ROTATION_SNAP_ANGLES;canvasInstance.on("object:rotating",function(e){const target=e.target;if(!target||target===contentImage||target===logo||target===logoName||typeof target.getCenterPoint!="function")return;let currentAngle=target.angle%360;currentAngle<0&&(currentAngle+=360);let closestAngle=null,minDifference=1/0;for(const snapAngle of snapAngles){let difference=Math.abs(currentAngle-snapAngle);difference>180&&(difference=360-difference),difference<minDifference&&(minDifference=difference,closestAngle=snapAngle)}if(closestAngle!==null&&minDifference<=tolerance){const centerBefore=target.getCenterPoint();target.set({angle:closestAngle});const centerAfter=target.getCenterPoint(),deltaX=centerBefore.x-centerAfter.x,deltaY=centerBefore.y-centerAfter.y;target.set({left:target.left+deltaX,top:target.top+deltaY}),target.setCoords(),!target._isSnapped||target._snappedTo,target._isSnapped=!0,target._snappedTo=closestAngle}else target._isSnapped=!1,target._snappedTo=null})},enablePictureMove(canvasInstance){canvasInstance.on("object:moving",function(options){if(options.target===contentImage){const imageRelatedHeight=options.target.height*(contentRect.width/contentImage.width),imageRelatedWidth=options.target.width*(contentRect.height/contentImage.height),maxTop=contentImage.top-contentRect.top-contentRect.height,maxLeft=contentImage.left-contentRect.left-contentRect.width;options.target.top>contentRect.top&&imageRelatedHeight>contentRect.height&&options.target.set({top:contentRect.top}).setCoords(),options.target.left>contentRect.left&&imageRelatedWidth>contentRect.width&&options.target.set({left:contentRect.left}).setCoords(),imageRelatedHeight>contentRect.height&&imageRelatedHeight<maxTop*-1&&options.target.set({top:contentRect.height-imageRelatedHeight+contentRect.top}).setCoords(),imageRelatedWidth>contentRect.width&&imageRelatedWidth<maxLeft*-1&&options.target.set({left:contentRect.width-imageRelatedWidth+contentRect.left}).setCoords()}})},positionBackgroundImage(){if(contentImage!=null){canvas.remove(contentRect),canvas.remove(contentImage),contentImage.selectable=!0,contentImage.top=contentRect.top,contentImage.left=contentRect.left,this.disableScalingControls(contentImage);const clipRect=new fabric.Rect({left:contentRect.left,top:contentRect.top,width:contentRect.width,height:contentRect.height,absolutePositioned:!0});contentRect.width>contentRect.height?(contentImage.scaleToWidth(contentRect.width),contentImage.lockMovementX=!0,contentImage.lockMovementY=!1):contentRect.width<contentRect.height||contentImage.width>contentImage.height?(contentImage.scaleToHeight(contentRect.height),contentImage.lockMovementY=!0,contentImage.lockMovementX=!1):(contentImage.scaleToWidth(contentRect.width),contentImage.lockMovementX=!0,contentImage.lockMovementY=!1),contentImage.clipPath=clipRect,canvas.add(contentImage),canvas.sendToBack(contentImage),canvas.centerObjectH(contentImage)}},bringLogoToFront(){logo&&canvas.bringToFront(logo),logoName&&canvas.bringToFront(logoName)},applyCircleClip(activeObject,sizePercentage=.7){if(!activeObject||!(activeObject&&activeObject!==contentImage&&activeObject!==contentRect&&activeObject!==logo&&activeObject!==logoName&&(activeObject.type==="image"||activeObject.type==="rect"||activeObject.type==="circle")))return!1;const originalWidth=activeObject.width,originalHeight=activeObject.height,radius=Math.min(originalHeight,originalWidth)*sizePercentage/2;if(activeObject.clipPath)activeObject.clipPath=null;else{const clipPath=new fabric.Circle({radius,left:0,top:0,originX:"center",originY:"center"});activeObject.clipPath=clipPath}return canvas.renderAll(),!0},exportCanvas(format,quality,targetDPI=200){const baseMultiplier=targetDPI/72,finalWidth=canvas.width*baseMultiplier,finalHeight=canvas.height*baseMultiplier,totalPixels=finalWidth*finalHeight;let actualMultiplier=baseMultiplier,actualDPI=targetDPI;totalPixels>25e7&&(actualMultiplier=Math.sqrt(25e7/(canvas.width*canvas.height)),actualDPI=Math.round(actualMultiplier*72));try{const dataURL=canvas.toDataURL({format,quality,multiplier:actualMultiplier});if(dataURL==="data:,")throw new Error("Canvas export failed - empty result");return{dataURL,actualDPI,targetDPI}}catch(error){throw error}}};window.CanvasUtils=CanvasUtils;const EventHandlerUtils={bindHandler(selector,event,handler){jQuery(selector).off(event).on(event,handler)},bindHandlers(handlerMap){Object.keys(handlerMap).forEach(selector=>{const handlers=handlerMap[selector];Object.keys(handlers).forEach(event=>{this.bindHandler(selector,event,handlers[event])})})},setupCanvasObjectHandlers(){const handlers={"#text":{input:__name(function(){setValue("text",jQuery(this).val())},"input")},"#scale":{input:__name(function(){const activeObject=canvas.getActiveObject();activeObject&&activeObject!==contentImage&&(activeObject.scale(parseFloat(this.value)).setCoords(),canvas.renderAll(),updateScale(activeObject))},"input")},"#text-color":{change:__name(function(){const activeObject=canvas.getActiveObject();activeObject&&activeObject.get("type")==="text"&&setValue("fill",jQuery(this).find(":selected").attr("value"))},"change")},'input[name="align"]':{change:__name(function(){const alignValue=jQuery(this).attr("id");setValue("textAlign",alignValue),jQuery(this).parent().trigger("update-status")},"change")},"#stroke-width":{input:__name(function(){const width=jQuery(this).val();setValue("strokeWidth",width==0?null:width)},"input")},"#shadow-depth":{input:__name(function(){setValue("shadow",createShadow("black",jQuery(this).val()))},"input")},"#font-style-select":{change:__name(function(){const activeObject=canvas.getActiveObject();if(activeObject&&activeObject.get("type")==="text"){const selectedFont=jQuery(this).val();setValue("fontFamily",selectedFont)}},"change")},"#line-height":{change:__name(function(){const activeObject=canvas.getActiveObject();if(activeObject&&activeObject.get("type")==="text"){const lineHeight=parseFloat(jQuery(this).val());setValue("lineHeight",lineHeight)}},"change")}};this.bindHandlers(handlers)},setupMainAppHandlers(){const handlers={"#canvas-template":{change:__name(function(){replaceCanvas(),typeof updateCanvasDimensions=="function"&&setTimeout(()=>{updateCanvasDimensions()},100)},"change")},"#logo-selection":{change:__name(function(){addLogo()},"change")},"#scale-direction":{change:__name(function(){CanvasUtils.positionBackgroundImage()},"change")},"#remove-element":{click:__name(function(){const activeObject=canvas.getActiveObject();activeObject&&activeObject!==contentImage&&activeObject!==logo&&canvas.remove(activeObject)},"click")},"#bring-to-front":{click:__name(function(){const activeObject=canvas.getActiveObject();activeObject&&activeObject!==contentImage&&activeObject!==contentRect&&(canvas.bringToFront(activeObject),CanvasUtils.bringLogoToFront(),canvas.renderAll())},"click")}};this.bindHandlers(handlers)},setupTextHandler(){this.bindHandler("#add-text","click",function(){const textValidation=ValidationUtils.validateTextInput(jQuery("#text").val());if(!textValidation.isValid){showAlert("Error! "+textValidation.error);return}const initialFontSize=canvas.width/2,selectedFont=jQuery("#font-style-select").val()||"Gotham Narrow Ultra Italic",text=new fabric.Text(jQuery("#text").val(),{fontFamily:selectedFont,fontSize:initialFontSize,fontStyle:"normal",textAlign:jQuery('input[name="align"]:checked').val(),fill:jQuery("#text-color").find(":selected").attr("value"),stroke:"#000000",strokeWidth:0,shadow:createShadow("#000000",jQuery("#shadow-depth").val()),objectCaching:!1,lineHeight:parseFloat(jQuery("#line-height").val())||1,centeredScaling:!1,selectable:!0,moveable:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!0});canvas.add(text),CanvasUtils.relativeScalingControlsOnly(text),CanvasUtils.scaleElementToFit(text,.8,.5),canvas.centerObject(text),text.set({top:canvas.height/2-text.getScaledHeight()/2}),text.setCoords(),canvas.setActiveObject(text),updateScale(text),canvas.renderAll()})},setupImageUploadHandler(){this.bindHandler("#add-image","input",function(){const file=this.files[0];if(!file)return;const fileValidation=ValidationUtils.isValidImageFile(file);if(jQuery("#add-image").val(""),!fileValidation){showAlert("Error! Invalid Image");return}const reader=new FileReader;reader.onload=function(){const image=new Image;image.src=reader.result,image.onload=function(){fabric.Image.fromURL(reader.result,function(fabricImage){CanvasUtils.scaleElementToFit(fabricImage,.5,.4),CanvasUtils.relativeScalingControlsOnly(fabricImage),canvas.add(fabricImage).setActiveObject(fabricImage),canvas.centerObject(fabricImage),updateScale(fabricImage),CanvasUtils.bringLogoToFront()},{opacity:jQuery("#opacity").val()})}},reader.readAsDataURL(file)})},setupCircleClipHandler(){this.bindHandler("#add-circle","click",function(){const activeObject=canvas.getActiveObject(),sizeString=jQuery("#circle-radius").val(),size=parseInt(sizeString)||2,validation=ValidationUtils.validateCircleClipTarget(activeObject);if(!validation.isValid){showAlert(validation.error,validation.type||"warning");return}const sizePercentage={2:.9,3:.7,4:.5}[size]||.7;CanvasUtils.applyCircleClip(activeObject,sizePercentage)})},setupPinkCircleHandler(){this.bindHandler("#add-pink-circle","click",function(){const radius=contentRect.width/4,pinkCircle=new fabric.Circle({top:contentRect.height/3,left:contentRect.width/3,radius,fill:"rgb(225,0,120)"});CanvasUtils.scaleElementToFit(pinkCircle,.3,.3),CanvasUtils.relativeScalingControlsOnly(pinkCircle),canvas.add(pinkCircle),canvas.getObjects().forEach(object=>{object.get("type")==="text"&&canvas.bringToFront(object)}),canvas.renderAll()})},setupCrossHandler(){this.bindHandler("#add-cross","click",function(){fabric.Image.fromURL(generatorApplicationURL+"resources/images/Ankreuzen.png",function(image){CanvasUtils.scaleElementToFit(image,.4,.3),canvas.add(image),canvas.centerObject(image),canvas.bringToFront(image)})})},setupQRCodeHandler(){this.bindHandler("#add-qr-code","click",function(){const qrText=jQuery("#qr-text").val().trim(),validation=ValidationUtils.validateQRInput(qrText);if(!validation.isValid){showAlert("Error! "+validation.error);return}const tempDiv=document.createElement("div");tempDiv.style.display="none",document.body.appendChild(tempDiv);try{const targetQRSize=Math.max(512,Math.min(2048,Math.floor(canvas.width/4))),qrColor=jQuery("#qr-color").val()||"#000000",qr=new QRCode(tempDiv,{text:qrText,width:targetQRSize,height:targetQRSize,colorDark:qrColor,colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.M});setTimeout(function(){const qrImg=tempDiv.querySelector("img");if(qrImg){const borderSize=Math.floor(targetQRSize*.05),totalSize=targetQRSize+borderSize*2,tempCanvas=document.createElement("canvas");tempCanvas.width=totalSize,tempCanvas.height=totalSize;const ctx=tempCanvas.getContext("2d");ctx.fillStyle="#ffffff",ctx.fillRect(0,0,totalSize,totalSize),ctx.drawImage(qrImg,borderSize,borderSize,targetQRSize,targetQRSize),fabric.Image.fromURL(tempCanvas.toDataURL(),function(qrImage){CanvasUtils.scaleElementToFit(qrImage,.25,.25),CanvasUtils.relativeScalingControlsOnly(qrImage),canvas.add(qrImage).setActiveObject(qrImage),canvas.centerObject(qrImage),updateScale(qrImage),CanvasUtils.bringLogoToFront(),document.body.removeChild(tempDiv)})}else showAlert("Error generating QR Code image"),document.body.removeChild(tempDiv)},100)}catch(error){showAlert("Error generating QR Code: "+error.message),document.body.removeChild(tempDiv)}})},setupDownloadHandler(){this.bindHandler("#generate-meme","click",function(){const validation=ValidationUtils.validateDownload();if(!validation.isValid){alert(validation.error);return}if(confirm("Hast du das Copyright bei Fotos \xFCberpr\xFCft und angegeben und das Impressum wo notwendig hinzugef\xFCgt?")){const targetDPI=template_values[template].dpi||200,format=jQuery("#image-format").find(":selected").attr("value"),quality=parseFloat(jQuery("#image-quality").find(":selected").attr("value"));try{const exportResult=CanvasUtils.exportCanvas(format,quality,targetDPI),link=document.createElement("a");link.href=exportResult.dataURL,link.download=createImgName(),link.click(),exportResult.actualDPI<exportResult.targetDPI&&alert(`Download erfolgreich mit ${exportResult.actualDPI} DPI (reduziert von ${exportResult.targetDPI} DPI f\xFCr Kompatibilit\xE4t)`)}catch(error){alert("Fehler beim Erstellen des Bildes. Das Format ist m\xF6glicherweise zu gro\xDF f\xFCr diesen Browser.")}}})},initializeAllHandlers(){this.setupCanvasObjectHandlers(),this.setupMainAppHandlers(),this.setupTextHandler(),this.setupImageUploadHandler(),this.setupCircleClipHandler(),this.setupPinkCircleHandler(),this.setupCrossHandler(),this.setupQRCodeHandler(),this.setupDownloadHandler()}};window.EventHandlerUtils=EventHandlerUtils;jQuery(function(){jQuery("#video-modal-btn").on("click",function(){const videoUrl=jQuery(this).data("video");jQuery("#video-iframe").attr("src",videoUrl),jQuery("#videoModal").removeClass("hidden"),jQuery("body").addClass("overflow-hidden")}),jQuery("#close-modal").on("click",function(e){jQuery("#videoModal").addClass("hidden"),jQuery("#video-iframe").attr("src",""),jQuery("body").removeClass("overflow-hidden")}),jQuery("#videoModal").on("click",function(e){e.target===this&&(jQuery("#videoModal").addClass("hidden"),jQuery("#video-iframe").attr("src",""),jQuery("body").removeClass("overflow-hidden"))}),jQuery(document).on("keydown",function(e){e.key==="Escape"&&(jQuery("#videoModal").addClass("hidden"),jQuery("#video-iframe").attr("src",""),jQuery("body").removeClass("overflow-hidden"))})});jQuery(function(){jQuery(".btn-group label").on("click",function(){const $label=jQuery(this),$group=$label.closest(".btn-group"),$radio=$label.find('input[type="radio"]');$group.find("label").removeClass("active").removeClass("bg-gruene-secondary"),$label.addClass("active").addClass("bg-gruene-secondary"),$radio.prop("checked",!0).trigger("change")})});const _SearchableSelect=class _SearchableSelect{constructor(element,options={}){this.element=jQuery(element),this.options=__spreadValues({placeholder:"Select an option...",searchPlaceholder:"Search...",noResultsText:"No results found"},options),this.isOpen=!1,this.selectedValue="",this.selectedText="",this.originalOptions=[],this.init()}init(){this.storeOriginalOptions(),this.createCustomSelect(),this.element.hide(),this.bindEvents();const initialValue=this.element.val();initialValue&&this.selectOption(initialValue)}storeOriginalOptions(){this.originalOptions=[],this.element.find("optgroup, option").each((index,el)=>{const $el=jQuery(el);if(el.tagName==="OPTGROUP")this.originalOptions.push({type:"group",label:$el.attr("label"),options:[]});else{const option={type:"option",value:$el.attr("value")||"",text:$el.text(),selected:$el.prop("selected")};this.originalOptions.length>0&&this.originalOptions[this.originalOptions.length-1].type==="group"?this.originalOptions[this.originalOptions.length-1].options.push(option):this.originalOptions.push(option)}})}createCustomSelect(){const customSelect=`
            <div class="searchable-select">
                <button type="button" class="searchable-select-button" aria-expanded="false">
                    <span class="searchable-select-text">${this.options.placeholder}</span>
                    <span class="searchable-select-chevron">
                        <svg class="h-5 w-5 text-gray-400 transform transition-transform" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                    </span>
                </button>
                <div class="searchable-select-dropdown hidden">
                    <input type="text" class="searchable-select-search" placeholder="${this.options.searchPlaceholder}">
                    <div class="searchable-select-options">
                        ${this.renderOptions()}
                    </div>
                </div>
            </div>
        `;this.customSelect=jQuery(customSelect),this.element.after(this.customSelect),this.button=this.customSelect.find(".searchable-select-button"),this.dropdown=this.customSelect.find(".searchable-select-dropdown"),this.searchInput=this.customSelect.find(".searchable-select-search"),this.optionsContainer=this.customSelect.find(".searchable-select-options"),this.textElement=this.customSelect.find(".searchable-select-text")}renderOptions(searchTerm=""){let html="";return this.originalOptions.forEach(item=>{if(item.type==="group"){const groupOptions=item.options.filter(opt=>{const searchLower=searchTerm.toLowerCase(),textMatch=opt.text.toLowerCase().includes(searchLower),valueMatch=opt.value.toLowerCase().includes(searchLower),valueSpaceMatch=opt.value.replace(/%/g," ").toLowerCase().includes(searchLower);return textMatch||valueMatch||valueSpaceMatch});groupOptions.length>0&&(html+=`<div class="searchable-select-option-group">${item.label}</div>`,groupOptions.forEach(option=>{const selectedClass=option.value===this.selectedValue?"selected":"";html+=`<div class="searchable-select-option ${selectedClass}" data-value="${option.value}">${option.text}</div>`}))}else if(item.type==="option"){const searchLower=searchTerm.toLowerCase(),textMatch=item.text.toLowerCase().includes(searchLower),valueMatch=item.value.toLowerCase().includes(searchLower),valueSpaceMatch=item.value.replace(/%/g," ").toLowerCase().includes(searchLower);if(textMatch||valueMatch||valueSpaceMatch){const selectedClass=item.value===this.selectedValue?"selected":"";html+=`<div class="searchable-select-option ${selectedClass}" data-value="${item.value}">${item.text}</div>`}}}),html===""&&searchTerm!==""&&(html=`<div class="px-3 py-2 text-gray-500 text-sm">${this.options.noResultsText}</div>`),html}bindEvents(){this.button.on("click",e=>{e.preventDefault(),this.toggle()}),jQuery(document).on("click",e=>{!this.customSelect.is(e.target)&&this.customSelect.has(e.target).length===0&&this.close()}),this.searchInput.on("input",e=>{const searchTerm=e.target.value;this.optionsContainer.html(this.renderOptions(searchTerm)),this.bindOptionEvents()}),this.searchInput.on("keydown",e=>{e.key==="Escape"&&this.close()}),this.bindOptionEvents()}bindOptionEvents(){this.optionsContainer.find(".searchable-select-option").off("click").on("click",e=>{const value=jQuery(e.target).data("value"),text=jQuery(e.target).text();this.selectOption(value,text),this.close()})}selectOption(value,text=null){if(this.selectedValue=value,text===null){const findOption=__name(items=>{for(let item of items)if(item.type==="group"){const found=findOption(item.options);if(found)return found}else if(item.value===value)return item;return null},"findOption"),option=findOption(this.originalOptions);text=option?option.text:value}this.selectedText=text,this.textElement.text(text||this.options.placeholder),this.element.val(value),this.element.trigger("change"),this.updateOptionStates()}updateOptionStates(){this.optionsContainer.find(".searchable-select-option").removeClass("selected"),this.optionsContainer.find(`[data-value="${this.selectedValue}"]`).addClass("selected")}toggle(){this.isOpen?this.close():this.open()}open(){this.dropdown.removeClass("hidden"),this.button.attr("aria-expanded","true"),this.customSelect.find(".searchable-select-chevron svg").addClass("rotate-180"),this.isOpen=!0,setTimeout(()=>{this.searchInput.focus()},10),this.searchInput.val(""),this.optionsContainer.html(this.renderOptions()),this.bindOptionEvents()}close(){this.dropdown.addClass("hidden"),this.button.attr("aria-expanded","false"),this.customSelect.find(".searchable-select-chevron svg").removeClass("rotate-180"),this.isOpen=!1}refresh(){this.storeOriginalOptions(),this.optionsContainer.html(this.renderOptions()),this.bindOptionEvents()}addOption(value,text,groupLabel=null){const option=jQuery(`<option value="${value}">${text}</option>`);if(groupLabel){let optgroup=this.element.find(`optgroup[label="${groupLabel}"]`);optgroup.length===0&&(optgroup=jQuery(`<optgroup label="${groupLabel}"></optgroup>`),this.element.append(optgroup)),optgroup.append(option)}else this.element.append(option);this.refresh()}clearOptions(){this.element.empty().append('<option value="">Select an option...</option>'),this.selectedValue="",this.selectedText="",this.textElement.text(this.options.placeholder),this.refresh()}};__name(_SearchableSelect,"SearchableSelect");let SearchableSelect=_SearchableSelect;jQuery.fn.searchableSelect=function(options){return this.each(function(){jQuery(this).data("searchable-select")||jQuery(this).data("searchable-select",new SearchableSelect(this,options))})};jQuery(function(){jQuery("#logo-selection").searchableSelect({placeholder:"Logo Ausw\xE4hlen",searchPlaceholder:"Logo suchen...",noResultsText:"Keine Logos gefunden"})});jQuery(function(){function waitForFabric(){typeof fabric!="undefined"?typeof initializeApplication=="function"&&initializeApplication():setTimeout(waitForFabric,50)}__name(waitForFabric,"waitForFabric"),waitForFabric()});function setValue(key,value){const activeObject=canvas.getActiveObject();activeObject&&(activeObject.set(key,value),canvas.renderAll())}__name(setValue,"setValue");function createShadow(color,width){return`${color} 2px 2px ${width}`}__name(createShadow,"createShadow");function toggleTextMethods(enable){const $textMethods=jQuery(".text-method"),$alignButtons=jQuery(".align");enable?($textMethods.attr("disabled",!1),$alignButtons.removeClass("disabled")):($textMethods.attr("disabled","disabled"),$alignButtons.addClass("disabled"))}__name(toggleTextMethods,"toggleTextMethods");function enableTextMethods(){toggleTextMethods(!0)}__name(enableTextMethods,"enableTextMethods");function createImgName(){const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let result="";for(let i=0;i<AppConstants.FILE.FILENAME_LENGTH;i++)result+=chars.charAt(Math.floor(Math.random()*chars.length));const format=jQuery("#image-format").find(":selected").attr("value");return`${result}.${format}`}__name(createImgName,"createImgName");jQuery(function(){jQuery(".memes-container").delegate("img","click",function(){var $img=jQuery(this),imgInfo={url:$img.attr("src"),height:$img.attr("img-height"),width:$img.attr("img-width")};processMeme(imgInfo)}),jQuery("#meme-input").on("change",function(){const file=this.files[0];if(!file)return;const fileType=file.type;if(jQuery("#meme-input").val(""),!ValidationUtils.isValidImageFile(file)){showAlert("Error! Invalid Image");return}const reader=new FileReader;reader.onload=function(){var meme=new Image;meme.onload=function(){processMeme({url:reader.result,height:meme.height,width:meme.width})},meme.onerror=function(){showAlert("Error loading image")},meme.src=reader.result},reader.onerror=function(){showAlert("Error reading file")},reader.readAsDataURL(file)})});function updateInputs(){const activeObject=canvas.getActiveObject();activeObject&&activeObject.get("type")==="text"&&(enableTextMethods(),jQuery("#text").val(activeObject.text),jQuery("#text-color").val(activeObject.fill),jQuery("#line-height").val(activeObject.lineHeight),jQuery("#font-style-select").val(activeObject.fontFamily),jQuery(`input[value="${activeObject.textAlign}"]`).parent().trigger("update-status"),updateScale(activeObject))}__name(updateInputs,"updateInputs");function updateScale(activeObject){const scale=Number(parseFloat(activeObject.scaleX)).toFixed(2);jQuery("#scale").val(scale)}__name(updateScale,"updateScale");function toggleSection(sectionId){const section=document.getElementById(sectionId),chevron=document.getElementById(sectionId+"-chevron"),button=document.querySelector(`[onclick="toggleSection('${sectionId}')"]`);section.style.display==="none"||section.classList.contains("hidden")?(section.style.display="block",section.classList.remove("hidden"),chevron.style.transform="rotate(0deg)",button.setAttribute("aria-expanded","true")):(section.style.display="none",section.classList.add("hidden"),chevron.style.transform="rotate(-90deg)",button.setAttribute("aria-expanded","false"))}__name(toggleSection,"toggleSection");jQuery(".edit-btn").on("update-status",function(){jQuery(this).attr("data")==""?jQuery(this).removeClass("active"):jQuery(this).addClass("active")});jQuery("#font-style .btn").on("click",function(){jQuery(this).attr("data")==""?(jQuery(this).addClass("active"),jQuery(this).attr("data",jQuery(this).attr("value"))):(jQuery(this).removeClass("active"),jQuery(this).attr("data","")),jQuery(this).trigger("change-value")});jQuery(".align").on("update-status",function(){jQuery(".align").removeClass("active"),jQuery(this).addClass("active")});window.toggleSection=toggleSection;let canvas,contentRect,contentImage,logo,logoName,logoText,scaleMax,template;if(typeof generatorApplicationURL=="undefined")var generatorApplicationURL="";window.generatorApplicationURL=generatorApplicationURL;function replaceCanvas(){template=jQuery("#canvas-template").find(":selected").attr("value"),canvas&&canvas.dispose();const currentTemplate2=TemplateConstants.getTemplate(template),{width,height,topBorderMultiplier,border}=currentTemplate2;function resizeCanvas(){const wrapperWidth=jQuery(".fabric-canvas-wrapper").width();jQuery(".canvas-container").css({width:wrapperWidth,height:wrapperWidth*height/width})}__name(resizeCanvas,"resizeCanvas"),jQuery(window).off("resize.canvas").on("resize.canvas",resizeCanvas),canvas=new fabric.Canvas("meme-canvas",{width,height,selection:!0,allowTouchScrolling:!0,backgroundColor:AppConstants.COLORS.BACKGROUND_PRIMARY,preserveObjectStacking:!0,targetFindTolerance:AppConstants.CANVAS.TARGET_FIND_TOLERANCE,perPixelTargetFind:!0}),scaleMax=canvas.width*AppConstants.CANVAS.SCALE_MAX_MULTIPLIER,jQuery("#scale").attr("max",scaleMax);const borderDistance=canvas.width/border,topDistance=borderDistance*topBorderMultiplier;contentRect=new fabric.Rect({top:topDistance,left:borderDistance,width:canvas.width-borderDistance*2,height:canvas.height-(topDistance+borderDistance),fill:AppConstants.COLORS.BACKGROUND_SECONDARY,selectable:!1}),canvas.add(contentRect),resizeCanvas(),CanvasUtils.enableSnap(canvas),CanvasUtils.enableRotationSnap(canvas),CanvasUtils.enablePictureMove(canvas),enableScalingUpdates(),addLogo(),canvas.renderAll(),typeof updateCanvasDimensions=="function"&&setTimeout(()=>{updateCanvasDimensions()},50)}__name(replaceCanvas,"replaceCanvas");function addLogo(){logo!=null&&(canvas.remove(logo),canvas.remove(logoName));const scaleTo=(contentRect.width+contentRect.height)/AppConstants.LOGO.SCALE_RATIO;logoText=(jQuery("#logo-selection").find(":selected").attr("value")||"").trim().toUpperCase();let logoFilename,textScaleTo;if(logoText.includes("%")||logoText.length>AppConstants.LOGO.MAX_TEXT_LENGTH){if(logoFilename=AppConstants.LOGO.FILES.LONG,logoText.includes("%"))logoText=logoText.split("%").map(part=>part.trim()).join(`
`);else if(logoText.length>AppConstants.LOGO.MAX_TEXT_LENGTH){const lastSpace=logoText.lastIndexOf(" ");lastSpace>0&&(logoText=logoText.substring(0,lastSpace).trim()+`
`+logoText.substring(lastSpace).trim())}textScaleTo=AppConstants.LOGO.TEXT_SCALE_LONG}else logoFilename=AppConstants.LOGO.FILES.SHORT,textScaleTo=AppConstants.LOGO.TEXT_SCALE_SHORT;scaleTo<121&&(logoFilename=logoFilename.replace("245","120").replace("248","121").replace("268","131")),fabric.Image.fromURL(generatorApplicationURL+"resources/images/logos/"+logoFilename,function(image){image.scaleToWidth(scaleTo),image.lockMovementX=!0,image.lockMovementY=!0,image.top=canvas.height*currentTemplate().logoTop,CanvasUtils.disableScalingControls(image),image.selectable=!1,canvas.add(image),canvas.centerObjectH(image),canvas.bringToFront(image),logo=image,logoName=new fabric.Text(logoText,{top:canvas.height*currentTemplate().logoTextTop,fontFamily:AppConstants.FONTS.DEFAULT_LOGO,fontSize:Math.floor(image.getScaledWidth()/10),fontStyle:"normal",textAlign:"right",fill:AppConstants.COLORS.LOGO_TEXT,stroke:AppConstants.COLORS.TEXT_STROKE,strokeWidth:0,objectCaching:!1,lineHeight:AppConstants.LOGO.LINE_HEIGHT,angle:AppConstants.LOGO.ANGLE,selectable:!1}),canvas.add(logoName);const linebreak=logoText.lastIndexOf(`
`);if(linebreak>17||logoText.length-linebreak>17){logoName.scaleToWidth(image.getScaledWidth()*AppConstants.LOGO.WIDTH_SCALE);const topAdd=Math.floor((logoName.height-logoName.getScaledHeight())/2);logoName.top=logoName.top+topAdd}else logoName.width=image.getScaledWidth()*AppConstants.LOGO.WIDTH_SCALE;canvas.centerObjectH(logoName),CanvasUtils.bringLogoToFront(),canvas.renderAll()})}__name(addLogo,"addLogo");function enableScalingUpdates(){canvas.on("object:scaling",function(options){updateScale(options.target)})}__name(enableScalingUpdates,"enableScalingUpdates");function initializeApplication(){replaceCanvas(),fabric.Object.prototype.set({transparentCorners:!1,cornerColor:AppConstants.COLORS.CORNER_COLOR,borderColor:AppConstants.COLORS.BORDER_COLOR,cornerSize:parseInt(canvas.width)*AppConstants.CANVAS.CORNER_SIZE_MULTIPLIER,cornerStrokeColor:AppConstants.COLORS.CORNER_STROKE,borderScaleFactor:AppConstants.CANVAS.BORDER_SCALE_FACTOR,padding:AppConstants.CANVAS.PADDING}),EventHandlerUtils.initializeAllHandlers(),canvas.on({"selection:created":updateInputs,"selection:updated":updateInputs,"selection:cleared":enableTextMethods}),window.canvas=canvas,window.processMeme=processMeme,window.contentImage=contentImage,window.contentRect=contentRect,window.logo=logo,window.logoName=logoName}__name(initializeApplication,"initializeApplication");function processMeme(memeInfo){fabric.Image.fromURL(`${memeInfo.url}`,function(meme){contentImage!=null&&canvas.remove(contentImage),contentImage=meme,window.contentImage=contentImage,positionBackgroundImage()},{crossOrigin:"anonymous"})}__name(processMeme,"processMeme");function positionBackgroundImage(){CanvasUtils.positionBackgroundImage()}__name(positionBackgroundImage,"positionBackgroundImage");function generateLogoSelection(data){const $logoSelect=jQuery("#logo-selection");jQuery.each(data,function(index,names){var items=[];jQuery.each(names.sort(),function(index2,name){items.push('<option value="'+name.toUpperCase()+'">'+name.replace("%"," ").toUpperCase()+"</option>")}),$logoSelect.append('<optgroup label="'+index+'">'+items.join("")+"</optgroup>")});const searchableSelect=$logoSelect.data("searchable-select");searchableSelect&&searchableSelect.refresh()}__name(generateLogoSelection,"generateLogoSelection");function loadLogoSelection(){if(typeof window.EMBEDDED_LOGO_DATA!="undefined"){generateLogoSelection(window.EMBEDDED_LOGO_DATA);return}const defaultIndex=generatorApplicationURL+"resources/images/logos/index.json";if(typeof logoDataOverride!="undefined"&&ValidationUtils.isValidJSON(logoDataOverride)){generateLogoSelection(jQuery.parseJSON(logoDataOverride));return}let logoIndex;typeof logoIndexOverride!="undefined"?logoIndex=logoIndexOverride:logoIndex=defaultIndex,jQuery.getJSON(logoIndex,function(data){generateLogoSelection(data)}).fail(function(jqxhr,textStatus,error){showAlert("Fehler beim Laden der Logo-Daten. Bitte Seite neu laden.","warning")})}__name(loadLogoSelection,"loadLogoSelection");loadLogoSelection();function autoPlayYouTubeModal(){var trigger=jQuery("body").find('[data-toggle="modal"]');trigger.click(function(){var theModal=jQuery(this).data("target"),videoSRC=jQuery(this).attr("data-theVideo"),videoSRCauto=videoSRC+"?autoplay=1";jQuery(theModal+" iframe").attr("src",videoSRCauto),jQuery(theModal+" button.close").click(function(){jQuery(theModal+" iframe").attr("src",videoSRC)})})}__name(autoPlayYouTubeModal,"autoPlayYouTubeModal");jQuery(document).ready(function(){autoPlayYouTubeModal()});let currentStep=1;const totalSteps=4;function initializeWizard(){currentStep=1,preloadFonts(),setupStepNavigation(),setupAdvancedOptions(),setupQRSection(),updateCanvasDimensions(),goToStep(1)}__name(initializeWizard,"initializeWizard");function preloadFonts(){[new FontFaceObserver("Gotham Narrow Ultra Italic"),new FontFaceObserver("Gotham Narrow Book"),new FontFaceObserver("Gotham Narrow Bold")].forEach(font=>{font.load().then(function(){}).catch(function(){})})}__name(preloadFonts,"preloadFonts");function setupStepNavigation(){jQuery("#step-1-indicator").on("click",function(){goToStep(1)}),jQuery("#step-2-indicator").on("click",function(){goToStep(2)}),jQuery("#step-3-indicator").on("click",function(){goToStep(3)}),jQuery("#step-4-indicator").on("click",function(){goToStep(4)}),jQuery("#step-1-indicator-mobile").on("click",function(){goToStep(1)}),jQuery("#step-2-indicator-mobile").on("click",function(){goToStep(2)}),jQuery("#step-3-indicator-mobile").on("click",function(){goToStep(3)}),jQuery("#step-4-indicator-mobile").on("click",function(){goToStep(4)}),jQuery("#step-1-next").on("click",function(){validateStep1()&&goToStep(2)}),jQuery("#step-2-next").on("click",function(){goToStep(3)}),jQuery("#step-3-next").on("click",function(){goToStep(4)}),jQuery("#step-2-back").on("click",function(){goToStep(1)}),jQuery("#step-3-back").on("click",function(){goToStep(2)}),jQuery("#step-4-back").on("click",function(){goToStep(3)}),jQuery("#start-over").on("click",function(){confirm("M\xF6chten Sie wirklich von vorne beginnen? Alle \xC4nderungen gehen verloren.")&&resetWizard()})}__name(setupStepNavigation,"setupStepNavigation");function validateStep1(){const validation=ValidationUtils.validateStep1();return validation.isValid?!0:(validation.errors.forEach(error=>{showAlert(error,"warning")}),!1)}__name(validateStep1,"validateStep1");function goToStep(stepNumber){stepNumber<1||stepNumber>totalSteps||(jQuery(".step-content").addClass("hidden"),jQuery(`#step-${stepNumber}`).removeClass("hidden"),updateStepIndicators(stepNumber),currentStep=stepNumber)}__name(goToStep,"goToStep");function updateStepIndicators(activeStep){for(let i=1;i<=totalSteps;i++){const indicator=jQuery(`#step-${i}-indicator`),mobileIndicator=jQuery(`#step-${i}-indicator-mobile`),stepContainer=indicator.closest(".flex.flex-col"),mobileContainer=mobileIndicator.closest(".flex.items-center");i<=activeStep?(indicator.removeClass("bg-gray-300 text-gray-600").addClass("bg-green-600 text-white active"),stepContainer.find("p").first().removeClass("text-gray-500").addClass("text-gray-900"),stepContainer.find("p").last().removeClass("text-gray-500").addClass("text-gray-600"),mobileIndicator.removeClass("bg-gray-300 text-gray-600").addClass("bg-green-600 text-white active"),mobileContainer.removeClass("bg-gray-50 border-gray-200").addClass("bg-green-50 border-green-200"),mobileContainer.find("p").first().removeClass("text-gray-500").addClass("text-gray-900"),mobileContainer.find("p").last().removeClass("text-gray-500").addClass("text-gray-600")):(indicator.removeClass("bg-green-600 text-white active").addClass("bg-gray-300 text-gray-600"),stepContainer.find("p").first().removeClass("text-gray-900").addClass("text-gray-500"),stepContainer.find("p").last().removeClass("text-gray-600").addClass("text-gray-500"),mobileIndicator.removeClass("bg-green-600 text-white active").addClass("bg-gray-300 text-gray-600"),mobileContainer.removeClass("bg-green-50 border-green-200").addClass("bg-gray-50 border-gray-200"),mobileContainer.find("p").first().removeClass("text-gray-900").addClass("text-gray-500"),mobileContainer.find("p").last().removeClass("text-gray-600").addClass("text-gray-500"))}for(let i=1;i<totalSteps;i++){const progressBar=jQuery(`#progress-${i}-${i+1}`);i<activeStep?progressBar.css("width","100%"):progressBar.css("width","0%")}}__name(updateStepIndicators,"updateStepIndicators");function resetWizard(){goToStep(1),jQuery("#text").val(""),jQuery("#qr-text").val(""),canvas&&(canvas.clear(),replaceCanvas()),jQuery("#qr-section").addClass("hidden"),showAlert("Neues Bild wird erstellt...","success")}__name(resetWizard,"resetWizard");function setupAdvancedOptions(){jQuery("#toggle-advanced").on("click",function(){const advancedOptions=jQuery("#advanced-options");!advancedOptions.hasClass("hidden")?(advancedOptions.addClass("hidden"),jQuery(this).attr("aria-expanded","false")):(advancedOptions.removeClass("hidden"),jQuery(this).attr("aria-expanded","true"))}),jQuery("#image-format").on("change",function(){const qualitySection=jQuery("#quality-section");jQuery(this).val()==="jpeg"?qualitySection.show():qualitySection.hide()})}__name(setupAdvancedOptions,"setupAdvancedOptions");function setupQRSection(){jQuery("#show-qr-section").on("click",function(){const qrSection=jQuery("#qr-section");qrSection.toggleClass("hidden"),qrSection.hasClass("hidden")||jQuery("#qr-text").focus()})}__name(setupQRSection,"setupQRSection");function updateCanvasDimensions(){if(canvas&&typeof currentTemplate=="function"){const template2=currentTemplate();if(template2){const dimensions=`${template2.width} \xD7 ${template2.height} px`,dpi=template2.dpi||200,displayText=`${dimensions} \u2022 ${dpi} DPI`;jQuery("#canvas-dimensions").text(displayText)}}else setTimeout(updateCanvasDimensions,500)}__name(updateCanvasDimensions,"updateCanvasDimensions");function saveSelectedOrganization(){const selectedOrg=jQuery("#logo-selection").val();selectedOrg&&localStorage.setItem("gruener-bildgenerator-organisation",selectedOrg)}__name(saveSelectedOrganization,"saveSelectedOrganization");function restoreSelectedOrganization(){const savedOrg=localStorage.getItem("gruener-bildgenerator-organisation");if(savedOrg){const $logoSelect=jQuery("#logo-selection"),searchableSelect=$logoSelect.data("searchable-select");$logoSelect.find("option").length>1&&searchableSelect?$logoSelect.find(`option[value="${savedOrg}"]`).length>0&&searchableSelect.selectOption(savedOrg):$logoSelect.find("option").length>1?$logoSelect.find(`option[value="${savedOrg}"]`).length>0&&($logoSelect.val(savedOrg),$logoSelect.trigger("change")):setTimeout(()=>restoreSelectedOrganization(),50)}}__name(restoreSelectedOrganization,"restoreSelectedOrganization");function setupAutoAdvance(){jQuery("#canvas-template, #logo-selection").on("change",function(){if(this.id==="logo-selection"&&saveSelectedOrganization(),setTimeout(()=>{updateCanvasDimensions()},200),currentStep===1){const template2=jQuery("#canvas-template").val(),logo2=jQuery("#logo-selection").val()}}),jQuery("#meme-input").on("change",function(){})}__name(setupAutoAdvance,"setupAutoAdvance");function enhanceCanvasIntegration(){const originalReplaceCanvas=window.replaceCanvas;window.replaceCanvas=function(){originalReplaceCanvas.apply(this,arguments),setTimeout(()=>{updateCanvasDimensions()},100)},canvas&&(canvas.on("object:added",function(e){}),canvas.on("object:removed",function(e){}))}__name(enhanceCanvasIntegration,"enhanceCanvasIntegration");function setupMobileEnhancements(){window.innerWidth<=768&&(jQuery(".step-indicator").addClass("mobile-compact"),jQuery(".btn-primary, .btn-secondary").addClass("touch-friendly"))}__name(setupMobileEnhancements,"setupMobileEnhancements");jQuery(document).ready(function(){initializeWizard(),setupAutoAdvance(),enhanceCanvasIntegration(),setupMobileEnhancements(),setTimeout(()=>{restoreSelectedOrganization()},100),setTimeout(()=>{updateCanvasDimensions()},1e3)});jQuery(window).on("resize",function(){updateCanvasDimensions(),setupMobileEnhancements()});window.goToStep=goToStep;const QRValidationHelpers={validateText:__name(function(text){if(!text||typeof text!="string")return{valid:!1,error:"Text ist erforderlich"};const trimmed=text.trim();return trimmed.length===0?{valid:!1,error:"Text darf nicht leer sein"}:trimmed.length>2e3?{valid:!1,error:"Text ist zu lang (maximal 2000 Zeichen)"}:{valid:!0,data:trimmed}},"validateText"),validateURL:__name(function(url){if(!url||typeof url!="string")return{valid:!1,error:"URL ist erforderlich"};let trimmed=url.trim();if(trimmed.length===0)return{valid:!1,error:"URL darf nicht leer sein"};trimmed.match(/^https?:\/\//i)||(trimmed="https://"+trimmed);try{const urlObj=new URL(trimmed);return urlObj.protocol!=="http:"&&urlObj.protocol!=="https:"?{valid:!1,error:"Nur HTTP und HTTPS URLs sind erlaubt"}:{valid:!0,data:urlObj.toString()}}catch(error){return{valid:!1,error:"Ung\xFCltige URL"}}},"validateURL"),validateEmail:__name(function(email){if(!email||typeof email!="string")return{valid:!1,error:"E-Mail-Adresse ist erforderlich"};const trimmed=email.trim();return trimmed.length===0?{valid:!1,error:"E-Mail-Adresse darf nicht leer sein"}:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(trimmed)?{valid:!0,data:trimmed}:{valid:!1,error:"Ung\xFCltige E-Mail-Adresse"}},"validateEmail"),validateVCard:__name(function(data){if(!data||typeof data!="object")return{valid:!1,error:"Ung\xFCltige Visitenkarten-Daten"};if(!data.lastname||data.lastname.trim().length===0)return{valid:!1,error:"Nachname ist erforderlich"};if(data.email&&data.email.trim().length>0){const emailValidation=this.validateEmail(data.email);if(!emailValidation.valid)return{valid:!1,error:"Ung\xFCltige E-Mail-Adresse: "+emailValidation.error}}if(data.website&&data.website.trim().length>0){const urlValidation=this.validateURL(data.website);if(!urlValidation.valid)return{valid:!1,error:"Ung\xFCltige Website-URL: "+urlValidation.error}}return{valid:!0,data}},"validateVCard")},QRFormatHelpers={formatText:__name(function(text){return text.trim()},"formatText"),formatURL:__name(function(url){let formatted=url.trim();return formatted.match(/^https?:\/\//i)||(formatted="https://"+formatted),formatted},"formatURL"),formatEmail:__name(function(email,subject="",body=""){let mailto=`mailto:${email.trim()}`;const params=[];return subject&&subject.trim().length>0&&params.push(`subject=${encodeURIComponent(subject.trim())}`),body&&body.trim().length>0&&params.push(`body=${encodeURIComponent(body.trim())}`),params.length>0&&(mailto+="?"+params.join("&")),mailto},"formatEmail"),formatVCard:__name(function(data){let vcard=`BEGIN:VCARD
`;vcard+=`VERSION:3.0
`;const title=(data.title||"").trim(),firstname=(data.firstname||"").trim(),lastname=(data.lastname||"").trim(),fullName=[title,firstname,lastname].filter(n=>n.length>0).join(" ");if(vcard+=`FN:${fullName}
`,vcard+=`N:${lastname};${firstname};;${title};
`,data.phone&&data.phone.trim().length>0&&(vcard+=`TEL:${data.phone.trim()}
`),data.email&&data.email.trim().length>0&&(vcard+=`EMAIL:${data.email.trim()}
`),data.address||data.city||data.zip){const address=(data.address||"").trim(),city=(data.city||"").trim(),zip=(data.zip||"").trim();vcard+=`ADR:;;${address};${city};;${zip};
`}if(data.website&&data.website.trim().length>0){let website=data.website.trim();website.match(/^https?:\/\//i)||(website="https://"+website),vcard+=`URL:${website}
`}return vcard+="END:VCARD",vcard},"formatVCard")},QRDisplayHelpers={getTypeDisplayName:__name(function(type){return{text:"Text",url:"Homepage",email:"E-Mail",vcard:"Visitenkarte"}[type]||type},"getTypeDisplayName"),getTypeIcon:__name(function(type){return{text:"fas fa-font",url:"fas fa-globe",email:"fas fa-envelope",vcard:"fas fa-user"}[type]||"fas fa-qrcode"},"getTypeIcon"),getColorDisplayName:__name(function(colorValue){return{"#000000":"Schwarz","#FFFFFF":"Wei\xDF","#538430":"Dunkelgr\xFCn","#82B624":"Hellgr\xFCn","#FFED00":"Gelb","#E6007E":"Magenta"}[colorValue]||colorValue},"getColorDisplayName"),getBackgroundDisplayName:__name(function(bgValue){return{"#FFFFFF":"Wei\xDF","#000000":"Schwarz",transparent:"Transparent"}[bgValue]||bgValue},"getBackgroundDisplayName"),generatePreviewText:__name(function(type,data,maxLength=50){if(!data)return"Keine Daten";let preview="";switch(type){case"text":preview=data;break;case"url":preview=data;break;case"email":data.startsWith("mailto:")?preview=new URL(data).pathname:preview=data;break;case"vcard":const nameMatch=data.match(/FN:(.+)/);nameMatch?preview=nameMatch[1]:preview="Visitenkarte";break;default:preview=data}return preview.length>maxLength&&(preview=preview.substring(0,maxLength-3)+"..."),preview},"generatePreviewText")},QRStorageHelpers={saveSettings:__name(function(settings){try{localStorage.setItem("qr-generator-settings",JSON.stringify(settings))}catch(error){}},"saveSettings"),loadSettings:__name(function(){try{const saved=localStorage.getItem("qr-generator-settings");return saved?JSON.parse(saved):null}catch(error){return null}},"loadSettings"),saveRecentQR:__name(function(qrData){try{let recent=this.getRecentQRs();recent.unshift(__spreadProps(__spreadValues({},qrData),{timestamp:Date.now()})),recent=recent.slice(0,10),localStorage.setItem("qr-generator-recent",JSON.stringify(recent))}catch(error){}},"saveRecentQR"),getRecentQRs:__name(function(){try{const saved=localStorage.getItem("qr-generator-recent");return saved?JSON.parse(saved):[]}catch(error){return[]}},"getRecentQRs"),clearRecentQRs:__name(function(){try{localStorage.removeItem("qr-generator-recent")}catch(error){}},"clearRecentQRs")},QRAnalyticsHelpers={trackGeneration:__name(function(type,success=!0){try{const stats=this.getStats();stats[type]||(stats[type]={total:0,successful:0,failed:0}),stats[type].total++,success?stats[type].successful++:stats[type].failed++,stats.lastUsed=Date.now(),localStorage.setItem("qr-generator-stats",JSON.stringify(stats))}catch(error){}},"trackGeneration"),getStats:__name(function(){try{const saved=localStorage.getItem("qr-generator-stats");return saved?JSON.parse(saved):{}}catch(error){return{}}},"getStats"),getMostUsedType:__name(function(){const stats=this.getStats();let maxType=null,maxCount=0;return Object.keys(stats).forEach(type=>{type!=="lastUsed"&&stats[type].total>maxCount&&(maxCount=stats[type].total,maxType=type)}),maxType},"getMostUsedType")},QRErrorHelpers={formatErrorMessage:__name(function(error,context=""){if(!error)return"Unbekannter Fehler";let message="";return typeof error=="string"?message=error:error.message?message=error.message:message="Ein unerwarteter Fehler ist aufgetreten",context&&(message=`${context}: ${message}`),message},"formatErrorMessage"),isRecoverableError:__name(function(error){if(!error)return!1;const message=error.message||error.toString();return[/network/i,/timeout/i,/temporary/i,/try again/i,/rate limit/i].some(pattern=>pattern.test(message))},"isRecoverableError"),getSuggestedAction:__name(function(error){if(!error)return"Seite neu laden und erneut versuchen";const message=error.message||error.toString();return message.includes("size")||message.includes("too large")?"Versuchen Sie k\xFCrzeren Text oder weniger Daten":message.includes("invalid")||message.includes("ung\xFCltig")?"\xDCberpr\xFCfen Sie Ihre Eingaben auf Richtigkeit":message.includes("network")||message.includes("fetch")?"\xDCberpr\xFCfen Sie Ihre Internetverbindung":this.isRecoverableError(error)?"Einen Moment warten und erneut versuchen":"Seite neu laden und erneut versuchen"},"getSuggestedAction")};window.QRValidationHelpers=QRValidationHelpers;window.QRFormatHelpers=QRFormatHelpers;window.QRDisplayHelpers=QRDisplayHelpers;window.QRStorageHelpers=QRStorageHelpers;window.QRAnalyticsHelpers=QRAnalyticsHelpers;window.QRErrorHelpers=QRErrorHelpers;jQuery(document).ready(function(){const savedSettings=QRStorageHelpers.loadSettings()});let qrPreviewCanvas=null;function generateQRPreview(isLiveUpdate=!1){if(!qrSelectedType){isLiveUpdate||showQRAlert("Kein Inhaltstyp ausgew\xE4hlt","error");return}try{const qrData=collectQRData();if(!qrData){isLiveUpdate||(clearQRPreview(),updateQRStatus("Geben Sie Daten ein f\xFCr die Vorschau"));return}updateQRStatus("QR-Code wird generiert...");const qrColor=jQuery("#qr-color-select").val()||"#000000",qrBackground=jQuery("#qr-background-select").val()||"#FFFFFF";generateQRCode(qrData,qrColor,qrBackground).then(qrCanvas=>{qrCanvas&&(displayQRPreview(qrCanvas),qrGeneratedCode={data:qrData,color:qrColor,background:qrBackground,canvas:qrCanvas},updateQRStatus(isLiveUpdate?"Vorschau aktualisiert":"QR-Code erfolgreich erstellt"))}).catch(error=>{isLiveUpdate||showQRAlert("Fehler beim Erstellen des QR-Codes: "+error.message,"error"),updateQRStatus("Fehler bei der Generierung")})}catch(error){isLiveUpdate||showQRAlert("Fehler bei der Vorschau: "+error.message,"error"),updateQRStatus("Vorschau-Fehler")}}__name(generateQRPreview,"generateQRPreview");function collectQRData(){if(!qrSelectedType)return null;try{switch(qrSelectedType){case"text":return jQuery("#qr-text-input").val().trim()||null;case"url":let url=jQuery("#qr-url-input").val().trim();return url?(url.match(/^https?:\/\//)||(url="https://"+url),url):null;case"email":const email=jQuery("#qr-email-address").val().trim();if(!email)return null;const subject=jQuery("#qr-email-subject").val().trim(),body=jQuery("#qr-email-body").val().trim();let mailto=`mailto:${email}`;const params=[];return subject&&params.push(`subject=${encodeURIComponent(subject)}`),body&&params.push(`body=${encodeURIComponent(body)}`),params.length>0&&(mailto+="?"+params.join("&")),mailto;case"vcard":return jQuery("#qr-vcard-lastname").val().trim()?generateVCard():null;default:return null}}catch(error){return null}}__name(collectQRData,"collectQRData");function generateVCard(){const fields={title:jQuery("#qr-vcard-title").val().trim(),firstname:jQuery("#qr-vcard-firstname").val().trim(),lastname:jQuery("#qr-vcard-lastname").val().trim(),phone:jQuery("#qr-vcard-phone").val().trim(),email:jQuery("#qr-vcard-email").val().trim(),address:jQuery("#qr-vcard-address").val().trim(),zip:jQuery("#qr-vcard-zip").val().trim(),city:jQuery("#qr-vcard-city").val().trim(),website:jQuery("#qr-vcard-website").val().trim()};let vcard=`BEGIN:VCARD
`;vcard+=`VERSION:3.0
`;const fullName=`${fields.title} ${fields.firstname} ${fields.lastname}`.trim();if(vcard+=`FN:${fullName}
`,vcard+=`N:${fields.lastname};${fields.firstname};;${fields.title};
`,fields.phone&&(vcard+=`TEL:${fields.phone}
`),fields.email&&(vcard+=`EMAIL:${fields.email}
`),(fields.address||fields.zip||fields.city)&&(vcard+=`ADR:;;${fields.address};${fields.city};;${fields.zip};
`),fields.website){let website=fields.website;website.match(/^https?:\/\//)||(website="https://"+website),vcard+=`URL:${website}
`}return vcard+="END:VCARD",vcard}__name(generateVCard,"generateVCard");function generateQRCode(data,foregroundColor,backgroundColor){return new Promise((resolve,reject)=>{try{const tempDiv=document.createElement("div");tempDiv.style.display="none",document.body.appendChild(tempDiv);const qrSize=512,options={text:data,width:qrSize,height:qrSize,colorDark:foregroundColor,colorLight:backgroundColor==="transparent"?"#FFFFFF":backgroundColor,correctLevel:QRCode.CorrectLevel.M,quietZone:backgroundColor!=="transparent"?Math.floor(qrSize*.05):0,quietZoneColor:backgroundColor==="transparent"?"transparent":backgroundColor};if(foregroundColor===backgroundColor&&backgroundColor!=="transparent"){reject(new Error("Vordergrund- und Hintergrundfarbe m\xFCssen unterschiedlich sein."));return}const qr=new QRCode(tempDiv,options);setTimeout(()=>{try{const qrImg=tempDiv.querySelector("img");if(!qrImg){document.body.removeChild(tempDiv),reject(new Error("QR-Code Bild konnte nicht generiert werden."));return}const canvas2=document.createElement("canvas"),ctx=canvas2.getContext("2d");let finalSize=qrSize,quietZoneSize=0;backgroundColor!=="transparent"&&(quietZoneSize=Math.floor(qrSize*.05),finalSize=qrSize+quietZoneSize*2),canvas2.width=finalSize,canvas2.height=finalSize,backgroundColor!=="transparent"&&(ctx.fillStyle=backgroundColor,ctx.fillRect(0,0,finalSize,finalSize)),qrImg.onload=()=>{ctx.drawImage(qrImg,quietZoneSize,quietZoneSize,qrSize,qrSize),document.body.removeChild(tempDiv),resolve(canvas2)},qrImg.complete&&(ctx.drawImage(qrImg,quietZoneSize,quietZoneSize,qrSize,qrSize),document.body.removeChild(tempDiv),resolve(canvas2))}catch(error){document.body.removeChild(tempDiv),reject(error)}},200)}catch(error){reject(error)}})}__name(generateQRCode,"generateQRCode");function displayQRPreview(canvas2){const previewContainer=jQuery("#qr-preview-display"),placeholder=jQuery("#qr-preview-placeholder");previewContainer.empty();const displayCanvas=document.createElement("canvas"),displayCtx=displayCanvas.getContext("2d"),maxSize=300,scale=Math.min(maxSize/canvas2.width,maxSize/canvas2.height);displayCanvas.width=canvas2.width*scale,displayCanvas.height=canvas2.height*scale,displayCtx.imageSmoothingEnabled=!1,displayCtx.webkitImageSmoothingEnabled=!1,displayCtx.mozImageSmoothingEnabled=!1,displayCtx.msImageSmoothingEnabled=!1,displayCtx.drawImage(canvas2,0,0,displayCanvas.width,displayCanvas.height),displayCanvas.style.maxWidth="100%",displayCanvas.style.height="auto",displayCanvas.style.border="1px solid #e5e7eb",displayCanvas.style.borderRadius="8px",displayCanvas.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.1)",previewContainer.append(displayCanvas).removeClass("hidden"),placeholder.addClass("hidden"),qrPreviewCanvas=canvas2}__name(displayQRPreview,"displayQRPreview");function clearQRPreview(){const previewContainer=jQuery("#qr-preview-display"),placeholder=jQuery("#qr-preview-placeholder");previewContainer.addClass("hidden").empty(),placeholder.removeClass("hidden"),qrPreviewCanvas=null,qrGeneratedCode=null,updateQRStatus("W\xE4hlen Sie einen Inhaltstyp")}__name(clearQRPreview,"clearQRPreview");function downloadQRCode(){if(!qrGeneratedCode||!qrPreviewCanvas){showQRAlert("Kein QR-Code zum Herunterladen verf\xFCgbar.","warning");return}try{const currentColor=jQuery("#qr-color-select").val(),currentBackground=jQuery("#qr-background-select").val();currentColor!==qrGeneratedCode.color||currentBackground!==qrGeneratedCode.background?(updateQRStatus("QR-Code wird mit neuen Einstellungen generiert..."),generateQRCode(qrGeneratedCode.data,currentColor,currentBackground).then(newCanvas=>{performDownload(newCanvas)}).catch(error=>{showQRAlert("Fehler beim Erstellen des finalen QR-Codes: "+error.message,"error")})):performDownload(qrPreviewCanvas)}catch(error){showQRAlert("Fehler beim Download: "+error.message,"error")}}__name(downloadQRCode,"downloadQRCode");function performDownload(canvas2){try{canvas2.toBlob(blob=>{if(!blob){showQRAlert("Fehler beim Erstellen der Bild-Datei.","error");return}const url=URL.createObjectURL(blob),link=document.createElement("a");link.href=url,link.download=generateQRFileName(),document.body.appendChild(link),link.click(),document.body.removeChild(link),URL.revokeObjectURL(url),updateQRStatus("QR-Code erfolgreich heruntergeladen"),showQRAlert("QR-Code wurde heruntergeladen!","success")},"image/png",1)}catch(error){showQRAlert("Fehler beim Download-Vorgang: "+error.message,"error")}}__name(performDownload,"performDownload");function generateQRFileName(){const type=qrSelectedType||"qrcode",timestamp=new Date().toISOString().split("T")[0];return`qrcode-${type}-${timestamp}.png`}__name(generateQRFileName,"generateQRFileName");function setupQRColorHandlers(){jQuery("#qr-color-select, #qr-background-select").on("change",function(){qrGeneratedCode&&qrCurrentStep===3&&setTimeout(()=>{generateQRPreview()},100)})}__name(setupQRColorHandlers,"setupQRColorHandlers");function initializeQRGenerator(){setupQRColorHandlers()}__name(initializeQRGenerator,"initializeQRGenerator");jQuery(document).ready(function(){});let qrCurrentStep=1;const qrTotalSteps=3;let qrSelectedType=null,qrGeneratedCode=null;function initializeQRWizard(){qrCurrentStep=1,qrSelectedType=null,qrGeneratedCode=null,setupQRStepNavigation(),setupQRTypeSelection(),qrGoToStep(1)}__name(initializeQRWizard,"initializeQRWizard");function setupQRStepNavigation(){jQuery("#qr-step-1-next").on("click",function(){validateQRStep1()&&qrGoToStep(2)}),jQuery("#qr-step-2-next").on("click",function(){validateQRStep2()&&qrGoToStep(3)}),jQuery("#qr-step-2-back").on("click",function(){qrGoToStep(1)}),jQuery("#qr-step-3-back").on("click",function(){qrGoToStep(2)}),jQuery("#qr-start-over").on("click",function(){confirm("M\xF6chten Sie wirklich einen neuen QR-Code erstellen? Alle Eingaben gehen verloren.")&&resetQRWizard()})}__name(setupQRStepNavigation,"setupQRStepNavigation");function setupQRTypeSelection(){jQuery(".qr-type-button").on("click",function(){const type=jQuery(this).data("type");selectQRType(type)})}__name(setupQRTypeSelection,"setupQRTypeSelection");function selectQRType(type){qrSelectedType=type,jQuery(".qr-type-button").removeClass("active bg-gruene-primary text-white").addClass("bg-white text-gray-700 border-gray-300"),jQuery(`.qr-type-button[data-type="${type}"]`).removeClass("bg-white text-gray-700 border-gray-300").addClass("active bg-gruene-primary text-white"),jQuery("#qr-step-1-next").prop("disabled",!1).removeClass("disabled:opacity-50"),updateQRStatus(`${getQRTypeDisplayName(type)} ausgew\xE4hlt`)}__name(selectQRType,"selectQRType");function getQRTypeDisplayName(type){return{text:"Text",url:"Homepage",email:"E-Mail",vcard:"Visitenkarte"}[type]||type}__name(getQRTypeDisplayName,"getQRTypeDisplayName");function qrGoToStep(stepNumber){stepNumber<1||stepNumber>qrTotalSteps||(jQuery(".qr-step-content").addClass("hidden"),jQuery(`#qr-step-${stepNumber}`).removeClass("hidden"),updateQRStepIndicators(stepNumber),qrCurrentStep=stepNumber,stepNumber===2?renderQRForm():stepNumber===3&&typeof generateQRPreview=="function"&&generateQRPreview())}__name(qrGoToStep,"qrGoToStep");function updateQRStepIndicators(activeStep){for(let i=1;i<=qrTotalSteps;i++){const indicator=jQuery(`#qr-step-${i}-indicator`),stepContainer=indicator.closest(".flex.flex-col");i<=activeStep?(indicator.removeClass("bg-gray-300 text-gray-600").addClass("bg-green-600 text-white active"),stepContainer.find("p").first().removeClass("text-gray-500").addClass("text-gray-900"),stepContainer.find("p").last().removeClass("text-gray-500").addClass("text-gray-600")):(indicator.removeClass("bg-green-600 text-white active").addClass("bg-gray-300 text-gray-600"),stepContainer.find("p").first().removeClass("text-gray-900").addClass("text-gray-500"),stepContainer.find("p").last().removeClass("text-gray-600").addClass("text-gray-500"))}for(let i=1;i<qrTotalSteps;i++){const progressBar=jQuery(`#qr-progress-${i}-${i+1}`);i<activeStep?progressBar.css("width","100%"):progressBar.css("width","0%")}}__name(updateQRStepIndicators,"updateQRStepIndicators");function renderQRForm(){const container=jQuery("#qr-form-container");if(container.empty(),!qrSelectedType){container.html('<p class="text-gray-500">Kein Inhaltstyp ausgew\xE4hlt</p>');return}let formHTML="";switch(qrSelectedType){case"text":formHTML=`
                <div>
                    <label for="qr-text-input" class="block text-sm font-medium text-gray-700 mb-2">
                        Ihr Text:
                    </label>
                    <textarea
                        id="qr-text-input"
                        class="form-input w-full"
                        rows="5"
                        placeholder="Geben Sie Ihren Text hier ein..."
                        required
                    ></textarea>
                </div>
            `;break;case"url":formHTML=`
                <div>
                    <label for="qr-url-input" class="block text-sm font-medium text-gray-700 mb-2">
                        Website-URL:
                    </label>
                    <input
                        type="url"
                        id="qr-url-input"
                        class="form-input w-full"
                        placeholder="https://www.beispiel.de"
                        required
                    />
                </div>
            `;break;case"email":formHTML=`
                <div class="space-y-4">
                    <div>
                        <label for="qr-email-address" class="block text-sm font-medium text-gray-700 mb-2">
                            E-Mail-Adresse:
                        </label>
                        <input
                            type="email"
                            id="qr-email-address"
                            class="form-input w-full"
                            placeholder="beispiel@gruene.at"
                            required
                        />
                    </div>
                    <div>
                        <label for="qr-email-subject" class="block text-sm font-medium text-gray-700 mb-2">
                            Betreff:
                        </label>
                        <input
                            type="text"
                            id="qr-email-subject"
                            class="form-input w-full"
                            placeholder="Betreff der E-Mail"
                        />
                    </div>
                    <div>
                        <label for="qr-email-body" class="block text-sm font-medium text-gray-700 mb-2">
                            Nachricht:
                        </label>
                        <textarea
                            id="qr-email-body"
                            class="form-input w-full"
                            rows="5"
                            placeholder="Nachrichtentext..."
                        ></textarea>
                    </div>
                </div>
            `;break;case"vcard":formHTML=`
                <div class="space-y-4">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label for="qr-vcard-title" class="block text-sm font-medium text-gray-700 mb-2">
                                Titel:
                            </label>
                            <input
                                type="text"
                                id="qr-vcard-title"
                                class="form-input w-full"
                                placeholder="Dr., Mag., etc."
                            />
                        </div>
                        <div>
                            <label for="qr-vcard-firstname" class="block text-sm font-medium text-gray-700 mb-2">
                                Vorname:
                            </label>
                            <input
                                type="text"
                                id="qr-vcard-firstname"
                                class="form-input w-full"
                                placeholder="Max"
                            />
                        </div>
                    </div>
                    <div>
                        <label for="qr-vcard-lastname" class="block text-sm font-medium text-gray-700 mb-2">
                            Nachname: *
                        </label>
                        <input
                            type="text"
                            id="qr-vcard-lastname"
                            class="form-input w-full"
                            placeholder="Mustermann"
                            required
                        />
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label for="qr-vcard-phone" class="block text-sm font-medium text-gray-700 mb-2">
                                Telefonnummer:
                            </label>
                            <input
                                type="tel"
                                id="qr-vcard-phone"
                                class="form-input w-full"
                                placeholder="+43 1 234 5678"
                            />
                        </div>
                        <div>
                            <label for="qr-vcard-email" class="block text-sm font-medium text-gray-700 mb-2">
                                E-Mail:
                            </label>
                            <input
                                type="email"
                                id="qr-vcard-email"
                                class="form-input w-full"
                                placeholder="max.mustermann@gruene.at"
                            />
                        </div>
                    </div>
                    <div>
                        <label for="qr-vcard-address" class="block text-sm font-medium text-gray-700 mb-2">
                            Stra\xDFe und Hausnummer:
                        </label>
                        <input
                            type="text"
                            id="qr-vcard-address"
                            class="form-input w-full"
                            placeholder="Musterstra\xDFe 123"
                        />
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label for="qr-vcard-zip" class="block text-sm font-medium text-gray-700 mb-2">
                                PLZ:
                            </label>
                            <input
                                type="text"
                                id="qr-vcard-zip"
                                class="form-input w-full"
                                placeholder="1010"
                            />
                        </div>
                        <div>
                            <label for="qr-vcard-city" class="block text-sm font-medium text-gray-700 mb-2">
                                Stadt:
                            </label>
                            <input
                                type="text"
                                id="qr-vcard-city"
                                class="form-input w-full"
                                placeholder="Wien"
                            />
                        </div>
                    </div>
                    <div>
                        <label for="qr-vcard-website" class="block text-sm font-medium text-gray-700 mb-2">
                            Homepage:
                        </label>
                        <input
                            type="url"
                            id="qr-vcard-website"
                            class="form-input w-full"
                            placeholder="https://www.gruene.at"
                        />
                    </div>
                    <div class="bg-blue-50 border border-blue-200 rounded-md p-3">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <i class="fas fa-info-circle text-blue-400"></i>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm text-blue-700">
                                    Alle Felder au\xDFer dem Nachnamen sind optional. 
                                    Der QR-Code wird auch bei Teilbef\xFCllung erstellt.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            `;break}container.html(formHTML),container.find("input, textarea").first().focus(),setupQRLivePreview()}__name(renderQRForm,"renderQRForm");function setupQRLivePreview(){jQuery("#qr-form-container input, #qr-form-container textarea").on("input",debounce(function(){qrCurrentStep===2&&(updateQRStatus("Vorschau wird aktualisiert..."),setTimeout(()=>{typeof generateQRPreview=="function"&&generateQRPreview(!0)},100))},300))}__name(setupQRLivePreview,"setupQRLivePreview");function validateQRStep1(){return qrSelectedType?!0:(showQRAlert("Bitte w\xE4hlen Sie einen Inhaltstyp aus.","warning"),!1)}__name(validateQRStep1,"validateQRStep1");function validateQRStep2(){if(!qrSelectedType)return showQRAlert("Kein Inhaltstyp ausgew\xE4hlt.","error"),!1;switch(qrSelectedType){case"text":if(!jQuery("#qr-text-input").val().trim())return showQRAlert("Bitte geben Sie einen Text ein.","warning"),jQuery("#qr-text-input").focus(),!1;break;case"url":const url=jQuery("#qr-url-input").val().trim();if(!url)return showQRAlert("Bitte geben Sie eine URL ein.","warning"),jQuery("#qr-url-input").focus(),!1;if(!isValidURL(url))return showQRAlert("Bitte geben Sie eine g\xFCltige URL ein.","warning"),jQuery("#qr-url-input").focus(),!1;break;case"email":if(!jQuery("#qr-email-address").val().trim())return showQRAlert("Bitte geben Sie eine E-Mail-Adresse ein.","warning"),jQuery("#qr-email-address").focus(),!1;break;case"vcard":if(!jQuery("#qr-vcard-lastname").val().trim())return showQRAlert("Bitte geben Sie mindestens einen Nachnamen ein.","warning"),jQuery("#qr-vcard-lastname").focus(),!1;break}return!0}__name(validateQRStep2,"validateQRStep2");function resetQRWizard(){qrCurrentStep=1,qrSelectedType=null,qrGeneratedCode=null,jQuery("#qr-form-container").empty(),jQuery(".qr-type-button").removeClass("active bg-gruene-primary text-white").addClass("bg-white text-gray-700 border-gray-300"),jQuery("#qr-step-1-next").prop("disabled",!0).addClass("disabled:opacity-50"),typeof clearQRPreview=="function"&&clearQRPreview(),qrGoToStep(1),updateQRStatus("W\xE4hlen Sie einen Inhaltstyp"),showQRAlert("Neuer QR-Code wird erstellt...","success")}__name(resetQRWizard,"resetQRWizard");function updateQRStatus(message){jQuery("#qr-status").text(message)}__name(updateQRStatus,"updateQRStatus");function showQRAlert(message,type="info"){if(typeof window.AlertSystem!="undefined"&&window.AlertSystem.showQRAlert)return window.AlertSystem.showQRAlert(message,type);typeof showAlert=="function"?showAlert(message,type):typeof showTailwindAlert=="function"&&showTailwindAlert(message,type)}__name(showQRAlert,"showQRAlert");function debounce(func,wait){let timeout;return __name(function(...args){const later=__name(()=>{clearTimeout(timeout),func.apply(this,args)},"later");clearTimeout(timeout),timeout=setTimeout(later,wait)},"executedFunction")}__name(debounce,"debounce");function isValidURL(string){try{return new URL(string),!0}catch(_){try{return new URL("https://"+string),!0}catch(_2){return!1}}}__name(isValidURL,"isValidURL");jQuery(document).ready(function(){});window.qrGoToStep=qrGoToStep;let qrHandlersInitialized=!1;function initializeQRHandlers(){qrHandlersInitialized||(setupTabNavigationHandlers(),setupQRDownloadHandler(),qrHandlersInitialized=!0)}__name(initializeQRHandlers,"initializeQRHandlers");function setupTabNavigationHandlers(){jQuery("#tab-generator").on("click",function(){switchToTab("generator")}),jQuery("#tab-qrcode").on("click",function(){switchToTab("qrcode")}),jQuery("#tab-generator-mobile").on("click",function(){switchToTab("generator")}),jQuery("#tab-qrcode-mobile").on("click",function(){switchToTab("qrcode")})}__name(setupTabNavigationHandlers,"setupTabNavigationHandlers");function switchToTab(tab){updateTabButtonStates(tab),tab==="generator"?(jQuery("#generator").removeClass("d-none").show(),jQuery("#qrcode-container").addClass("d-none").hide(),document.title="Gr\xFCner Bildgenerator"):tab==="qrcode"&&(jQuery("#generator").addClass("d-none").hide(),jQuery("#qrcode-container").removeClass("d-none").show(),typeof initializeQRWizard=="function"&&initializeQRWizard(),typeof initializeQRGenerator=="function"&&initializeQRGenerator(),document.title="QR-Code Generator - Gr\xFCne"),localStorage.setItem("gruener-generator-current-tab",tab)}__name(switchToTab,"switchToTab");function updateTabButtonStates(activeTab){["#tab-generator","#tab-qrcode"].forEach(tabSelector=>{const tab=jQuery(tabSelector);activeTab==="generator"&&tabSelector.includes("generator")||activeTab==="qrcode"&&tabSelector.includes("qrcode")?tab.removeClass("bg-gray-200 text-gray-700").addClass("bg-gruene-primary text-white active"):tab.removeClass("bg-gruene-primary text-white active").addClass("bg-gray-200 text-gray-700")}),["#tab-generator-mobile","#tab-qrcode-mobile"].forEach(tabSelector=>{const tab=jQuery(tabSelector);activeTab==="generator"&&tabSelector.includes("generator")||activeTab==="qrcode"&&tabSelector.includes("qrcode")?tab.removeClass("bg-gray-200 text-gray-700").addClass("bg-gruene-primary text-white active"):tab.removeClass("bg-gruene-primary text-white active").addClass("bg-gray-200 text-gray-700")})}__name(updateTabButtonStates,"updateTabButtonStates");function setupQRDownloadHandler(){jQuery("#qr-download").on("click",function(){typeof downloadQRCode=="function"?downloadQRCode():showQRAlert("Download-Funktion nicht verf\xFCgbar","error")})}__name(setupQRDownloadHandler,"setupQRDownloadHandler");function handleQRHashNavigation(){const hash=window.location.hash;hash==="#qrcode-tab"?switchToTab("qrcode"):(hash==="#generator-tab"||hash==="")&&switchToTab("generator")}__name(handleQRHashNavigation,"handleQRHashNavigation");function setupQRHashNavigation(){handleQRHashNavigation(),jQuery(window).on("hashchange",handleQRHashNavigation),jQuery("#tab-generator, #tab-generator-mobile").on("click",function(){window.location.hash="#generator-tab"}),jQuery("#tab-qrcode, #tab-qrcode-mobile").on("click",function(){window.location.hash="#qrcode-tab"})}__name(setupQRHashNavigation,"setupQRHashNavigation");function restoreLastTab(){const savedTab=localStorage.getItem("gruener-generator-current-tab");if(window.location.hash==="#qrcode-tab"){switchToTab("qrcode");return}switchToTab(savedTab&&(savedTab==="generator"||savedTab==="qrcode")?savedTab:"generator")}__name(restoreLastTab,"restoreLastTab");function setupQRBrowserNavigation(){window.addEventListener("popstate",function(event){handleQRHashNavigation()})}__name(setupQRBrowserNavigation,"setupQRBrowserNavigation");function setupQRKeyboardShortcuts(){jQuery(document).on("keydown",function(e){jQuery("input:focus, textarea:focus, select:focus").length>0||(e.altKey&&e.key==="1"?(e.preventDefault(),switchToTab("generator"),window.location.hash="#generator-tab"):e.altKey&&e.key==="2"&&(e.preventDefault(),switchToTab("qrcode"),window.location.hash="#qrcode-tab"))})}__name(setupQRKeyboardShortcuts,"setupQRKeyboardShortcuts");function setupQRErrorHandling(){window.addEventListener("error",function(event){event.filename&&event.filename.includes("qrcode")&&typeof showQRAlert=="function"&&showQRAlert("Ein unerwarteter Fehler ist aufgetreten. Bitte versuchen Sie es erneut.","error")}),window.addEventListener("unhandledrejection",function(event){event.reason&&typeof event.reason=="object"&&event.reason.message&&(event.reason.message.includes("QR")||event.reason.message.includes("qr"))&&(typeof showQRAlert=="function"&&showQRAlert("Fehler bei der QR-Code Verarbeitung: "+event.reason.message,"error"),event.preventDefault())})}__name(setupQRErrorHandling,"setupQRErrorHandling");function setupQRResponsiveBehavior(){function handleResize(){const width=window.innerWidth;width>=768?(jQuery(".nav-tab").removeClass("hidden").show(),jQuery(".nav-tab-mobile").addClass("hidden").hide()):(jQuery(".nav-tab").addClass("hidden").hide(),jQuery(".nav-tab-mobile").removeClass("hidden").show()),width<640?jQuery(".qr-preview-container canvas").css({"max-width":"280px","max-height":"280px"}):jQuery(".qr-preview-container canvas").css({"max-width":"300px","max-height":"300px"})}__name(handleResize,"handleResize"),handleResize(),jQuery(window).on("resize",debounce(handleResize,250))}__name(setupQRResponsiveBehavior,"setupQRResponsiveBehavior");function setupQRFormValidation(){jQuery(document).on("input",'input[type="url"]',function(){const input=jQuery(this),value=input.val().trim();if(value&&!isValidURL(value)){input.addClass("border-red-300 focus:border-red-500");let hint=input.next(".validation-hint");hint.length===0&&(hint=jQuery('<div class="validation-hint text-xs text-red-600 mt-1">G\xFCltige URL eingeben (z.B. https://www.beispiel.de)</div>'),input.after(hint))}else input.removeClass("border-red-300 focus:border-red-500"),input.next(".validation-hint").remove()}),jQuery(document).on("input",'input[type="email"]',function(){const input=jQuery(this),value=input.val().trim();if(value&&!isValidEmail(value)){input.addClass("border-red-300 focus:border-red-500");let hint=input.next(".validation-hint");hint.length===0&&(hint=jQuery('<div class="validation-hint text-xs text-red-600 mt-1">G\xFCltige E-Mail-Adresse eingeben</div>'),input.after(hint))}else input.removeClass("border-red-300 focus:border-red-500"),input.next(".validation-hint").remove()})}__name(setupQRFormValidation,"setupQRFormValidation");function isValidEmail(email){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)}__name(isValidEmail,"isValidEmail");function initializeQRHandlersWithErrorHandling(){try{initializeQRHandlers(),setupQRHashNavigation(),setupQRBrowserNavigation(),setupQRKeyboardShortcuts(),setupQRErrorHandling(),setupQRResponsiveBehavior(),setupQRFormValidation(),setTimeout(restoreLastTab,100)}catch(error){setTimeout(()=>{try{initializeQRHandlers(),restoreLastTab()}catch(fallbackError){}},500)}}__name(initializeQRHandlersWithErrorHandling,"initializeQRHandlersWithErrorHandling");jQuery(document).ready(function(){initializeQRHandlersWithErrorHandling()});})();
//# sourceMappingURL=app.min.js.map
